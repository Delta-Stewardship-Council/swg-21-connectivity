---
title: "explore_nuts" #Explore Nutrients - April 2022
output: html_document
editor_options: 
  chunk_output_type: console
---
# read in data, break stations up by region, subset data (lines 88 - 137)
##explore dissolved nitrate + nitrite by region (lines 138 - 285) 
###explore dissolved ammonium by region (lines 287 - 408)
####explore dissolved inorganic nitroten aka DIN (ammonium + nitrate + nitrite) by region (lines 410 - 531)
#####explore prediction of nitrogen by Q at Freeport (not good, lines 533 - end)


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#load libraries 
```{r}
library(readr)
library(dplyr)
library(stats)
library(tidyr)
library(ggplot2)
library(ggpubr)
library(lubridate)
library(signal)
library(dataRetrieval)
#remotes::install_github("USGS-R/dataRetrieval")
```
#Tidal filter function

#Tgodinfn() - godin filter (tidal filter)

```{r}
# Code for tidal filtering of water level data in R, using Godin approach

# PA Work, USGS California Water Science Center
# pwork@usgs.gov
# date: 2017-03-23

# note: this code assumes that it is being passed two vectors, both with no missing values:
# 1) a vector containing times of observations, at uniform time steps of 15 min
# 2) a corresponding vector of observations to be filtered, also with no missing values
# within the program these are called tint and xint, respectively
# filtered time series is called tfilt
# units of variable being filtered are unimportant

# 36 hours of data are deleted at the beginning and end of the filtered time series

Tgodinfn<-function(tint,xint) {

# apply Godin filter
# it includes three passes in time domain, with windows 24, 24, and 25 hrs long
# will assume 15-min data here, so
# for first pass, 48 points have to be skipped and last 44
# window is 12-1-11 hrs in length, i.e. use previous 12 hours and
# subsequent 11 hrs to define result at 13th hour.
  
xfilt<-rep_len(NA,length.out=length(xint))

# do first pass, with window of 12,1,11 hrs
for (i in seq(from=49,to=(length(xint)-44))) {
  xfilt[i]=sum(xint[(i-48):(i+44)])/93 
}

xfilt1<-xfilt
# now 2nd pass, same approach but window is 11,1,12 hrs
for (i in seq(from=45, to=(length(xint)-48))) {
xfilt1[i]=sum(xfilt[(i-44):(i+48)])/93;
}
xfilt=xfilt1;
# now 3rd pass with 12-1-12 window
for (i in seq(from=49,to=(length(xint)-48))) {
xfilt[i]=sum(xfilt1[(i-48):(i+48)])/97;
}                                                                  
# Now throw away 36 hrs at each end
xfilt[1:(36*4)]<-NA
isize=length(xfilt)
xfilt[(isize-36*4):isize]<-NA

return(xfilt)

}
```

#read in data
```{r}
explore <- read.csv("data_model/model_chla_nuts_combined.csv")

inun <- read.csv("data_model/inundation_with_doy1998.csv")

dat_na <- data.frame(sapply(X = explore, FUN = function(x) sum(is.na(x))))
```
#remove forms of N if not paired with chlorophyll ##break stations up by region 
```{r}

new_dat <- explore[,c(2:5, 7,10,12,14,15)]

new_dat_chl <- new_dat[!is.na(new_dat$chlorophyll),]

sum(is.na(new_dat_chl$diss_nitrate_nitrite == TRUE))

plot(new_dat_chl$latitude, new_dat_chl$diss_nitrate_nitrite)

new_dat_chl$date <- as.POSIXct(new_dat_chl$date, format = "%Y-%m-%d")

unique(new_dat_chl$station_wq_chl)

RV <- subset(new_dat_chl, latitude>=38.13&latitude<= 38.22)

unique(RV$station_wq_chl)

plot(RV$latitude, RV$diss_nitrate_nitrite)

CSC <- subset(new_dat_chl, latitude>=38.221&latitude<= 38.35)

unique(CSC$station_wq_chl)

plot(CSC$latitude, CSC$diss_nitrate_nitrite)

Yolo <- subset(new_dat_chl, latitude>=38.3501&longitude<=-121.568291)

unique(Yolo$station_wq_chl)

SacR <- subset(new_dat_chl, longitude>=-121.5727)

unique(SacR$station_wq_chl)
```
#subset data >= WY 2009  
```{r}
Yolo_2009 <- subset(Yolo, date>="2008-10-01")
CSC_2009 <- subset(CSC, date>="2008-10-01")
SacR_2009 <- subset(SacR, date>="2008-10-01")
RV_2009 <- subset(RV, date>="2008-10-01")
```
#explore Yolo diss_nitrate_nitrite
```{r}
Yolo_2009$date <- as.Date(Yolo_2009$date)

plot(Yolo_2009$date, Yolo_2009$diss_nitrate_nitrite,
xlim=as.Date(c("2013-01-01", "2020-12-31")))

Yolo_2009$date <- as.Date(Yolo_2009$date)

Yolo_2009$month <- months(Yolo_2009$date, abbreviate = TRUE)

ggplot(Yolo_2009, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Yolo')

ggplot(Yolo_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Yolo')

```
#add inundation to Yolo for plot explore - smaller range of concentratios during inundation period
```{r}
inun$date <- as.Date(inun$date)

Yolo_inun_nuts <- merge(Yolo_2009, inun, by="date", all.x="TRUE")

plot(Yolo_inun_nuts$date, Yolo_inun_nuts$diss_nitrate_nitrite, col = ifelse (Yolo_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2013-01-01", "2020-12-31")))

Yolo_inun_nuts$inundation <- as.character(Yolo_inun_nuts$inundation)

ggplot(Yolo_inun_nuts, aes(inundation, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('Yolo')
```
#Yolo - explore inundation vs. non-inun
```{r}

Yolo_non_nuts <- subset(Yolo_inun_nuts, inundation==0)

ggplot(Yolo_non_nuts, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Yolo')

Yolo_flood_nuts <- subset(Yolo_inun_nuts, inundation==1)

ggplot(Yolo_flood_nuts, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Yolo')
```
#explore CSC diss_nitrate_nitrite

```{r}
CSC_2009$date <- as.Date(CSC_2009$date)

plot(CSC_2009$date, CSC_2009$diss_nitrate_nitrite,
xlim=as.Date(c("2014-10-01", "2020-12-31")))

CSC_2009$date <- as.Date(CSC_2009$date)

CSC_2009$month <- months(CSC_2009$date, abbreviate = TRUE)

ggplot(CSC_2009, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('CSC')

```
#add inundation to CSC for plot explore 

```{r}
CSC_inun_nuts <- merge(CSC_2009, inun, by="date", all.x="TRUE")

plot(CSC_inun_nuts$date, CSC_inun_nuts$diss_nitrate_nitrite, col = ifelse (CSC_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2015-01-01", "2020-12-31")))

CSC_inun_nuts$inundation <- as.character(CSC_inun_nuts$inundation)

ggplot(CSC_inun_nuts, aes(inundation, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('CSC')

plot(CSC_inun_nuts$diss_nitrate_nitrite, CSC_inun_nuts$chlorophyll)
```
#CSC - explore inundation vs. non-inun
```{r}
CSC_non_nuts <- subset(CSC_inun_nuts, inundation==0)

ggplot(CSC_non_nuts, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('CSC')

CSC_flood_nuts <- subset(CSC_inun_nuts, inundation==1)

ggplot(CSC_flood_nuts, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('CSC')
```
# explore Rio Vista diss_nitrate_nitrite
```{r}
RV_2009$date <- as.Date(RV_2009$date)

RV_2009$month <- months(RV_2009$date, abbreviate = TRUE)

plot(RV_2009$date, RV_2009$diss_nitrate_nitrite,
xlim=as.Date(c("2012-06-13", "2020-12-31")))

ggplot(RV_2009, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Rio Vista')

ggplot(RV_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Rio Vista')
```
#add inundation to Rio Vista for plot explore

```{r}
RV_inun_nuts <- merge(RV_2009, inun, by="date", all.x="TRUE")

plot(RV_inun_nuts$date, RV_inun_nuts$diss_nitrate_nitrite, col = ifelse (RV_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2008-10-01", "2020-12-31")))

RV_inun_nuts$inundation <- as.character(RV_inun_nuts$inundation)

ggplot(RV_inun_nuts, aes(inundation, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('Rio Vista')

plot(RV_inun_nuts$diss_nitrate_nitrite, RV_inun_nuts$chlorophyll)
```
#Rio Vista - explore inundation vs. non-inun
```{r}
RV_non_nuts <- subset(RV_inun_nuts, inundation==0)

ggplot(RV_non_nuts, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('RV')

RV_flood_nuts <- subset(RV_inun_nuts, inundation==1)

ggplot(RV_flood_nuts, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('RV')
```
# explore Sacramento R diss_nitrate_nitrite
```{r}
SacR_2009$date <- as.Date(SacR_2009$date)

plot(SacR_2009$date, SacR_2009$diss_nitrate_nitrite,
xlim=as.Date(c("2015-10-01", "2020-12-31")))

SacR_2009$month <- months(SacR_2009$date, abbreviate = TRUE)

ggplot(SacR_2009, aes(month, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Sac R')

ggplot(SacR_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Sac R')
```
#add inundation to Sac R for plot explore

```{r}

SacR_inun_nuts <- merge(SacR_2009, inun, by="date", all.x="TRUE")

plot(SacR_inun_nuts$date, SacR_inun_nuts$diss_nitrate_nitrite, col = ifelse (SacR_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2015-01-01", "2020-12-31")))

SacR_inun_nuts$inundation <- as.character(SacR_inun_nuts$inundation)

ggplot(SacR_inun_nuts, aes(inundation, diss_nitrate_nitrite))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('SacR')

plot(SacR_inun_nuts$diss_nitrate_nitrite, SacR_inun_nuts$chlorophyll)
```

```{r}
#calc interquartile ranges for each region
summary(RV_2009$diss_nitrate_nitrite)
summary(SacR_2009$diss_nitrate_nitrite)
summary(CSC_2009$diss_nitrate_nitrite)
summary(Yolo_2009$diss_nitrate_nitrite)
```

#explore Yolo diss_ammonium
```{r}
Yolo_2009$date <- as.Date(Yolo_2009$date)

plot(Yolo_2009$date, Yolo_2009$diss_ammonia,
xlim=as.Date(c("2013-01-01", "2020-12-31")))

Yolo_2009$date <- as.Date(Yolo_2009$date)

Yolo_2009$month <- months(Yolo_2009$date, abbreviate = TRUE)

ggplot(Yolo_2009, aes(month, diss_ammonia))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Yolo')

ggplot(Yolo_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Yolo')

```
#add inundation to Yolo for plot explore - smaller range of concentratios during inundation period
```{r}
inun$date <- as.Date(inun$date)

Yolo_inun_nuts <- merge(Yolo_2009, inun, by="date", all.x="TRUE")

plot(Yolo_inun_nuts$date, Yolo_inun_nuts$diss_ammonia, col = ifelse (Yolo_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2013-01-01", "2020-12-31")))

Yolo_inun_nuts$inundation <- as.character(Yolo_inun_nuts$inundation)

ggplot(Yolo_inun_nuts, aes(inundation, diss_ammonia))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('Yolo')
```
#explore CSC diss_ammonia

```{r}
CSC_2009$date <- as.Date(CSC_2009$date)

plot(CSC_2009$date, CSC_2009$diss_ammonia,
xlim=as.Date(c("2014-10-01", "2020-12-31")))

CSC_2009$date <- as.Date(CSC_2009$date)

CSC_2009$month <- months(CSC_2009$date, abbreviate = TRUE)

ggplot(CSC_2009, aes(month, diss_ammonia))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('CSC')

```

#add inundation to CSC for plot explore 

```{r}
CSC_inun_nuts <- merge(CSC_2009, inun, by="date", all.x="TRUE")

plot(CSC_inun_nuts$date, CSC_inun_nuts$diss_ammonia, col = ifelse (CSC_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2015-01-01", "2020-12-31")))

CSC_inun_nuts$inundation <- as.character(CSC_inun_nuts$inundation)

ggplot(CSC_inun_nuts, aes(inundation, diss_ammonia))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('CSC')

plot(CSC_inun_nuts$diss_ammonia, CSC_inun_nuts$chlorophyll)
```

# explore Rio Vista diss_ammonia
```{r}
RV_2009$date <- as.Date(RV_2009$date)

RV_2009$month <- months(RV_2009$date, abbreviate = TRUE)

plot(RV_2009$date, RV_2009$diss_ammonia,
xlim=as.Date(c("2012-06-13", "2020-12-31")))

ggplot(RV_2009, aes(month, diss_ammonia))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Rio Vista')

ggplot(RV_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Rio Vista')
```

#add inundation to Rio Vista for plot explore

```{r}
RV_inun_nuts <- merge(RV_2009, inun, by="date", all.x="TRUE")

plot(RV_inun_nuts$date, RV_inun_nuts$diss_ammonia, col = ifelse (RV_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2008-10-01", "2020-12-31")))

RV_inun_nuts$inundation <- as.character(RV_inun_nuts$inundation)

ggplot(RV_inun_nuts, aes(inundation, diss_ammonia))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('Rio Vista')

plot(RV_inun_nuts$diss_ammonia, RV_inun_nuts$chlorophyll)
```
# explore Sacramento R diss_ammonia
```{r}
SacR_2009$date <- as.Date(SacR_2009$date)

plot(SacR_2009$date, SacR_2009$diss_ammonia,
xlim=as.Date(c("2015-10-01", "2020-12-31")))

SacR_2009$month <- months(SacR_2009$date, abbreviate = TRUE)

ggplot(SacR_2009, aes(month, diss_ammonia))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Sac R')

ggplot(SacR_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Sac R')
```

#add inundation to Sac R for plot explore

```{r}

SacR_inun_nuts <- merge(SacR_2009, inun, by="date", all.x="TRUE")

plot(SacR_inun_nuts$date, SacR_inun_nuts$diss_ammonia, col = ifelse (SacR_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2015-01-01", "2020-12-31")))

SacR_inun_nuts$inundation <- as.character(SacR_inun_nuts$inundation)

ggplot(SacR_inun_nuts, aes(inundation, diss_ammonia))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('SacR')

plot(SacR_inun_nuts$diss_ammonia, SacR_inun_nuts$chlorophyll)
```

#calc interquartile ranges for each region

```{r}
summary(RV_2009$diss_ammonia)
summary(SacR_2009$diss_ammonia)
summary(CSC_2009$diss_ammonia)
summary(Yolo_2009$diss_ammonia)
```

#explore Yolo dissolved inorganic nitrogen (din)
```{r}
Yolo_2009$date <- as.Date(Yolo_2009$date)

plot(Yolo_2009$date, Yolo_2009$din,
xlim=as.Date(c("2013-01-01", "2020-12-31")))

Yolo_2009$date <- as.Date(Yolo_2009$date)

Yolo_2009$month <- months(Yolo_2009$date, abbreviate = TRUE)

ggplot(Yolo_2009, aes(month, din))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Yolo')

ggplot(Yolo_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Yolo')

```
#add inundation to Yolo for plot explore - smaller range of concentratios during inundation period
```{r}
inun$date <- as.Date(inun$date)

Yolo_inun_nuts <- merge(Yolo_2009, inun, by="date", all.x="TRUE")

plot(Yolo_inun_nuts$date, Yolo_inun_nuts$din, col = ifelse (Yolo_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2013-01-01", "2020-12-31")))

Yolo_inun_nuts$inundation <- as.character(Yolo_inun_nuts$inundation)

ggplot(Yolo_inun_nuts, aes(inundation, din))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('Yolo')
```
#explore CSC din

```{r}
CSC_2009$date <- as.Date(CSC_2009$date)

plot(CSC_2009$date, CSC_2009$din,
xlim=as.Date(c("2014-10-01", "2020-12-31")))

CSC_2009$date <- as.Date(CSC_2009$date)

CSC_2009$month <- months(CSC_2009$date, abbreviate = TRUE)

ggplot(CSC_2009, aes(month, din))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('CSC')

```

#add inundation to CSC for plot explore 

```{r}
CSC_inun_nuts <- merge(CSC_2009, inun, by="date", all.x="TRUE")

plot(CSC_inun_nuts$date, CSC_inun_nuts$din, col = ifelse (CSC_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2015-01-01", "2020-12-31")))

CSC_inun_nuts$inundation <- as.character(CSC_inun_nuts$inundation)

ggplot(CSC_inun_nuts, aes(inundation, din))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('CSC')

plot(CSC_inun_nuts$din, CSC_inun_nuts$chlorophyll)
```

# explore Rio Vista din
```{r}
RV_2009$date <- as.Date(RV_2009$date)

RV_2009$month <- months(RV_2009$date, abbreviate = TRUE)

plot(RV_2009$date, RV_2009$din,
xlim=as.Date(c("2012-06-13", "2020-12-31")))

ggplot(RV_2009, aes(month, din))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Rio Vista')

ggplot(RV_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Rio Vista')
```

#add inundation to Rio Vista for plot explore

```{r}
RV_inun_nuts <- merge(RV_2009, inun, by="date", all.x="TRUE")

plot(RV_inun_nuts$date, RV_inun_nuts$din, col = ifelse (RV_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2008-10-01", "2020-12-31")))

RV_inun_nuts$inundation <- as.character(RV_inun_nuts$inundation)

ggplot(RV_inun_nuts, aes(inundation, din))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('Rio Vista')

plot(RV_inun_nuts$din, RV_inun_nuts$chlorophyll)
```
# explore Sacramento R din
```{r}
SacR_2009$date <- as.Date(SacR_2009$date)

plot(SacR_2009$date, SacR_2009$din,
xlim=as.Date(c("2015-10-01", "2020-12-31")))

SacR_2009$month <- months(SacR_2009$date, abbreviate = TRUE)

ggplot(SacR_2009, aes(month, din))+ geom_boxplot() + scale_x_discrete(limits = month.abb) +ggtitle('Sac R')

ggplot(SacR_2009, aes(month, chlorophyll))+ geom_boxplot() + scale_x_discrete(limits = month.abb)+ggtitle('Sac R')
```

#add inundation to Sac R for plot explore

```{r}

SacR_inun_nuts <- merge(SacR_2009, inun, by="date", all.x="TRUE")

plot(SacR_inun_nuts$date, SacR_inun_nuts$din, col = ifelse (SacR_inun_nuts$inundation>0, "red", "black"), xlim=as.Date(c("2015-01-01", "2020-12-31")))

SacR_inun_nuts$inundation <- as.character(SacR_inun_nuts$inundation)

ggplot(SacR_inun_nuts, aes(inundation, din))+ geom_boxplot() + scale_x_discrete(breaks = c("0", "1")) +ggtitle('SacR')

plot(SacR_inun_nuts$din, SacR_inun_nuts$chlorophyll)
```

#calc interquartile ranges for each region

```{r}
summary(SacR_2009$din)
summary(CSC_2009$din)
summary(Yolo_2009$din)
summary(RV_2009$din)
```

#explore if Sac R Q can predict dissolved_nitrate_nitrite
```{r}
siteNumbers <- c("11447650")

startDate <- "2008-10-01"

endDate <- "2019-12-30"

parameterCd <- c("00060")

uvFPT <- readNWISuv(siteNumbers,parameterCd,startDate,endDate, tz = "Etc/GMT+8") #will take ~1 min to run. daily values not available for entire record...retrieving 15 min data and downstepping to daily mean at line 495

FPT <- uvFPT[,c(3:4)] %>% rename(date = dateTime, FPT_Q_cfs = X_00060_00000)

#apply godin filter to Q - Tgodinfn()

FPT$FPT_Q_tf_cfs <- Tgodinfn(FPT$date, FPT$FPT_Q_cfs)

#downstep to daily mean

dvFPT <- FPT %>%mutate(date = as.Date(date)) %>%group_by(date) 

#join Freeport to Sac R nutrients and inun df

SacR_FPT <- left_join(SacR_inun_nuts, dvFPT, by = "date" )

plot(SacR_FPT$FPT_Q_tf_cfs, SacR_FPT$din)

lm <- lm(SacR_FPT$din~SacR_FPT$FPT_Q_tf_cfs)
summary(lm)

#join Freeport to Yolo nutrients and inun df

Yolo_FPT <- left_join(Yolo_inun_nuts, dvFPT, by = "date" )

plot(Yolo_FPT$FPT_Q_tf_cfs, Yolo_FPT$din)

lm <- lm(Yolo_FPT$din~Yolo_FPT$FPT_Q_tf_cfs)
summary(lm)

#join Freeport to CSC nutrients and inun df

CSC_FPT <- left_join(CSC_inun_nuts, dvFPT, by = "date" )

plot(CSC_FPT$FPT_Q_tf_cfs, CSC_FPT$din)

lm <- lm(CSC_FPT$din~CSC_FPT$FPT_Q_tf_cfs)
summary(lm)
```
